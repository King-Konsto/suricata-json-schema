{"$schema": "http://json-schema.org/schema#", "required": ["event_type", "timestamp"], "type": "object", "properties": {"event_type": {"type": "string"}, "stream": {"type": "integer"}, "app_proto_orig": {"type": "string"}, "packet": {"type": "string"}, "dnp3": {"type": "object", "properties": {"control": {"required": ["dir", "fcb", "fcv", "function_code", "pri"], "type": "object", "properties": {"function_code": {"type": "integer"}, "fcb": {"type": "boolean"}, "pri": {"type": "boolean"}, "fcv": {"type": "boolean"}, "dir": {"type": "boolean"}}}, "src": {"type": "integer"}, "dst": {"type": "integer"}, "request": {"required": ["application", "control", "dst", "src", "type"], "type": "object", "properties": {"control": {"required": ["dir", "fcb", "fcv", "function_code", "pri"], "type": "object", "properties": {"function_code": {"type": "integer"}, "fcb": {"type": "boolean"}, "pri": {"type": "boolean"}, "fcv": {"type": "boolean"}, "dir": {"type": "boolean"}}}, "src": {"type": "integer"}, "dst": {"type": "integer"}, "type": {"type": "string"}, "application": {"required": ["complete", "control", "function_code", "objects"], "type": "object", "properties": {"control": {"required": ["con", "fin", "fir", "sequence", "uns"], "type": "object", "properties": {"fir": {"type": "boolean"}, "uns": {"type": "boolean"}, "fin": {"type": "boolean"}, "sequence": {"type": "integer"}, "con": {"type": "boolean"}}}, "function_code": {"type": "integer"}, "objects": {"items": {"required": ["count", "group", "prefix_code", "qualifier", "range_code", "start", "stop", "variation"], "type": "object", "properties": {"count": {"type": "integer"}, "group": {"type": "integer"}, "qualifier": {"type": "integer"}, "prefix_code": {"type": "integer"}, "stop": {"type": "integer"}, "variation": {"type": "integer"}, "start": {"type": "integer"}, "points": {"items": {"required": ["index", "prefix"], "type": "object", "properties": {"block_number": {"type": "integer"}, "reserved": {"type": "integer"}, "status_code": {"type": "integer"}, "op_type": {"type": "integer"}, "data->wrapped_key_data": {"type": "string"}, "prefix": {"type": "integer"}, "file_size": {"type": "integer"}, "cr": {"type": "integer"}, "offtime": {"type": "integer"}, "user_number": {"type": "integer"}, "tcc": {"type": "integer"}, "size": {"type": "integer"}, "index": {"type": "integer"}, "ksq": {"type": "integer"}, "filename": {"type": "string"}, "state": {"type": "integer"}, "usr": {"type": "integer"}, "authentication_key": {"type": "integer"}, "operational_mode": {"type": "integer"}, "timestamp": {"type": "integer"}, "maximum_block_size": {"type": "integer"}, "filename_size": {"type": "integer"}, "qu": {"type": "integer"}, "filename_offset": {"type": "integer"}, "permissions": {"type": "integer"}, "count": {"type": "integer"}, "file_handle": {"type": "integer"}, "ontime": {"type": "integer"}, "created": {"type": "integer"}, "file_data": {"type": "string"}, "request_id": {"type": "integer"}}}, "type": "array"}, "range_code": {"type": "integer"}}}, "type": "array"}, "complete": {"type": "boolean"}}}}}, "application": {"required": ["complete", "control", "function_code", "objects"], "type": "object", "properties": {"control": {"required": ["con", "fin", "fir", "sequence", "uns"], "type": "object", "properties": {"fir": {"type": "boolean"}, "uns": {"type": "boolean"}, "fin": {"type": "boolean"}, "sequence": {"type": "integer"}, "con": {"type": "boolean"}}}, "function_code": {"type": "integer"}, "objects": {"items": {"required": ["count", "group", "prefix_code", "qualifier", "range_code", "start", "stop", "variation"], "type": "object", "properties": {"count": {"type": "integer"}, "group": {"type": "integer"}, "qualifier": {"type": "integer"}, "prefix_code": {"type": "integer"}, "stop": {"type": "integer"}, "variation": {"type": "integer"}, "start": {"type": "integer"}, "points": {"items": {"required": ["index", "prefix"], "type": "object", "properties": {"block_number": {"type": "integer"}, "reserved": {"type": "integer"}, "data->challenge_data": {"type": "string"}, "status_code": {"type": "integer"}, "op_type": {"type": "integer"}, "data->wrapped_key_data": {"type": "string"}, "challenge_data_len": {"type": "integer"}, "prefix": {"type": "integer"}, "file_size": {"type": "integer"}, "cr": {"type": "integer"}, "offtime": {"type": "integer"}, "user_number": {"type": "integer"}, "reserved0": {"type": "integer"}, "size": {"type": "integer"}, "index": {"type": "integer"}, "ksq": {"type": "integer"}, "reserved1": {"type": "integer"}, "data->mac_value": {"type": "string"}, "key_status": {"type": "integer"}, "chatter_filter": {"type": "integer"}, "filename": {"type": "string"}, "state": {"type": "integer"}, "optional_text": {"type": "string"}, "usr": {"type": "integer"}, "online": {"type": "integer"}, "authentication_key": {"type": "integer"}, "remote_forced": {"type": "integer"}, "operational_mode": {"type": "integer"}, "timestamp": {"type": "integer"}, "maximum_block_size": {"type": "integer"}, "local_forced": {"type": "integer"}, "key_wrap_alg": {"type": "integer"}, "filename_size": {"type": "integer"}, "file_handle": {"type": "integer"}, "filename_offset": {"type": "integer"}, "mal": {"type": "integer"}, "restart": {"type": "integer"}, "permissions": {"type": "integer"}, "count": {"type": "integer"}, "qu": {"type": "integer"}, "ontime": {"type": "integer"}, "created": {"type": "integer"}, "file_data": {"type": "string"}, "tcc": {"type": "integer"}, "value": {"type": "integer"}, "over_range": {"type": "integer"}, "request_id": {"type": "integer"}, "comm_lost": {"type": "integer"}, "delay_ms": {"type": "integer"}, "reference_err": {"type": "integer"}}}, "type": "array"}, "range_code": {"type": "integer"}}}, "type": "array"}, "complete": {"type": "boolean"}}}, "iin": {"required": ["indicators"], "type": "object", "properties": {"indicators": {"items": {"type": "string"}, "type": "array"}}}, "type": {"type": "string"}, "response": {"required": ["application", "control", "dst", "iin", "src", "type"], "type": "object", "properties": {"control": {"required": ["dir", "fcb", "fcv", "function_code", "pri"], "type": "object", "properties": {"function_code": {"type": "integer"}, "fcb": {"type": "boolean"}, "pri": {"type": "boolean"}, "fcv": {"type": "boolean"}, "dir": {"type": "boolean"}}}, "src": {"type": "integer"}, "dst": {"type": "integer"}, "application": {"required": ["complete", "control", "function_code", "objects"], "type": "object", "properties": {"control": {"required": ["con", "fin", "fir", "sequence", "uns"], "type": "object", "properties": {"fir": {"type": "boolean"}, "uns": {"type": "boolean"}, "fin": {"type": "boolean"}, "sequence": {"type": "integer"}, "con": {"type": "boolean"}}}, "function_code": {"type": "integer"}, "objects": {"items": {"required": ["count", "group", "points", "prefix_code", "qualifier", "range_code", "start", "stop", "variation"], "type": "object", "properties": {"count": {"type": "integer"}, "group": {"type": "integer"}, "qualifier": {"type": "integer"}, "prefix_code": {"type": "integer"}, "stop": {"type": "integer"}, "variation": {"type": "integer"}, "start": {"type": "integer"}, "points": {"items": {"required": ["index", "prefix"], "type": "object", "properties": {"reserved": {"type": "integer"}, "data->challenge_data": {"type": "string"}, "status_code": {"type": "integer"}, "op_type": {"type": "integer"}, "challenge_data_len": {"type": "integer"}, "prefix": {"type": "integer"}, "file_size": {"type": "integer"}, "cr": {"type": "integer"}, "offtime": {"type": "integer"}, "user_number": {"type": "integer"}, "tcc": {"type": "integer"}, "size": {"type": "integer"}, "index": {"type": "integer"}, "ksq": {"type": "integer"}, "reserved1": {"type": "integer"}, "data->mac_value": {"type": "string"}, "key_status": {"type": "integer"}, "chatter_filter": {"type": "integer"}, "reserved0": {"type": "integer"}, "state": {"type": "integer"}, "optional_text": {"type": "string"}, "online": {"type": "integer"}, "remote_forced": {"type": "integer"}, "timestamp": {"type": "integer"}, "maximum_block_size": {"type": "integer"}, "local_forced": {"type": "integer"}, "key_wrap_alg": {"type": "integer"}, "file_handle": {"type": "integer"}, "mal": {"type": "integer"}, "restart": {"type": "integer"}, "count": {"type": "integer"}, "qu": {"type": "integer"}, "ontime": {"type": "integer"}, "value": {"type": "integer"}, "over_range": {"type": "integer"}, "request_id": {"type": "integer"}, "comm_lost": {"type": "integer"}, "delay_ms": {"type": "integer"}, "reference_err": {"type": "integer"}}}, "type": "array"}, "range_code": {"type": "integer"}}}, "type": "array"}, "complete": {"type": "boolean"}}}, "iin": {"required": ["indicators"], "type": "object", "properties": {"indicators": {"items": {"type": "string"}, "type": "array"}}}, "type": {"type": "string"}}}}}, "fileinfo": {"required": ["file_id", "filename", "gaps", "size", "state", "stored", "tx_id"], "type": "object", "properties": {"size": {"type": "integer"}, "sha1": {"type": "string"}, "magic": {"type": "string"}, "filename": {"type": "string"}, "tx_id": {"type": "integer"}, "state": {"type": "string"}, "stored": {"type": "boolean"}, "gaps": {"type": "boolean"}, "file_id": {"type": "integer"}, "sha256": {"type": "string"}, "md5": {"type": "string"}}}, "icmp_type": {"type": "integer"}, "packet_info": {"required": ["linktype"], "type": "object", "properties": {"linktype": {"type": "integer"}}}, "payload": {"type": "string"}, "dest_port": {"type": "integer"}, "payload_printable": {"type": "string"}, "src_port": {"type": "integer"}, "vars": {"type": "object", "properties": {"flowbits": {"type": "object", "properties": {"ET.Symantec.Site.Download": {"type": "boolean"}, "et.IE7.NoRef.NoCookie": {"type": "boolean"}, "ET.EOT.Download": {"type": "boolean"}, "tcp.retransmission.alerted": {"type": "boolean"}, "ET.INFO.WindowsUpdate": {"type": "boolean"}, "ET.xls.dde.drop": {"type": "boolean"}, "et.http.PK": {"type": "boolean"}, "ET.RIGEKExploit": {"type": "boolean"}, "exe.no.referer": {"type": "boolean"}, "ET.realEDUrequest": {"type": "boolean"}, "ET.smb.binary": {"type": "boolean"}, "http.dottedquadhost.dll": {"type": "boolean"}, "ET.zipfile": {"type": "boolean"}, "is_proto_irc": {"type": "boolean"}, "ms.rdp.synack": {"type": "boolean"}, "et.MS.XMLHTTP.no.exe.request": {"type": "boolean"}, "ET.SuspExeTLDs": {"type": "boolean"}, "ET.pdf.in.http": {"type": "boolean"}, "ET.HB.Request.SI": {"type": "boolean"}, "http.dottedquadhost": {"type": "boolean"}}}, "flowints": {"type": "object", "properties": {"tls.anomaly.count": {"type": "integer"}, "tcp.retransmission.count": {"type": "integer"}, "applayer.anomaly.count": {"type": "integer"}, "http.anomaly.count": {"type": "integer"}}}}}, "timestamp": {"type": "string"}, "proto": {"type": "string"}, "pcap_cnt": {"type": "integer"}, "src_ip": {"type": "string"}, "dns": {"required": ["id", "type"], "type": "object", "properties": {"grouped": {"patternProperties": {"[A-Z]+": {}}}, "type": {"type": "string"}, "rrtype": {"type": "string"}, "rrname": {"type": "string"}, "rdata": {"type": "string"}, "tx_id": {"type": "integer"}, "ttl": {"type": "integer"}, "rcode": {"type": "string"}, "id": {"type": "integer"}}}, "flow_id": {"type": "integer"}, "email": {"required": ["status"], "type": "object", "properties": {"status": {"type": "string"}, "from": {"type": "string"}, "subject_md5": {"type": "string"}, "to": {"items": {"type": "string"}, "type": "array"}, "attachment": {"items": {"type": "string"}, "type": "array"}, "body_md5": {"type": "string"}}}, "dest_ip": {"type": "string"}, "icmp_code": {"type": "integer"}, "http": {"required": ["length"], "type": "object", "properties": {"status": {"type": "integer"}, "redirect": {"type": "string"}, "http_user_agent": {"type": "string"}, "protocol": {"type": "string"}, "http_refer": {"type": "string"}, "url": {"type": "string"}, "http_response_body_printable": {"type": "string"}, "hostname": {"type": "string"}, "http_request_body": {"type": "string"}, "length": {"type": "integer"}, "http_request_body_printable": {"type": "string"}, "http_response_body": {"type": "string"}, "http_method": {"type": "string"}, "http_content_type": {"type": "string"}}}, "smtp": {"required": ["helo"], "type": "object", "properties": {"rcpt_to": {"items": {"type": "string"}, "type": "array"}, "mail_from": {"type": "string"}, "helo": {"type": "string"}}}, "vlan": {"anyOf": [{"type": "integer"}, {"items": {"type": "integer"}, "type": "array"}]}, "alert": {"required": ["action", "category", "gid", "rev", "severity", "signature", "signature_id"], "type": "object", "properties": {"category": {"type": "string"}, "severity": {"type": "integer"}, "rev": {"type": "integer"}, "gid": {"type": "integer"}, "signature": {"type": "string"}, "action": {"type": "string"}, "signature_id": {"type": "integer"}}}, "tcp": {"required": ["tcp_flags"], "type": "object", "properties": {"tcp_flags": {"type": "string"}, "psh": {"type": "boolean"}, "urg": {"type": "boolean"}, "tcp_flags_tc": {"type": "string"}, "ack": {"type": "boolean"}, "ecn": {"type": "boolean"}, "cwr": {"type": "boolean"}, "syn": {"type": "boolean"}, "state": {"type": "string"}, "tcp_flags_ts": {"type": "string"}, "rst": {"type": "boolean"}, "fin": {"type": "boolean"}}}, "stats": {"required": ["app_layer", "decoder", "defrag", "detect", "dns", "file_store", "flow", "flow_mgr", "http", "tcp", "threads", "uptime"], "type": "object", "properties": {"flow_mgr": {"required": ["bypassed_pruned", "bypassed_pruned_delta", "closed_pruned", "closed_pruned_delta", "est_pruned", "est_pruned_delta", "flows_checked", "flows_checked_delta", "flows_notimeout", "flows_notimeout_delta", "flows_removed", "flows_removed_delta", "flows_timeout", "flows_timeout_delta", "flows_timeout_inuse", "flows_timeout_inuse_delta", "new_pruned", "new_pruned_delta", "rows_busy", "rows_busy_delta", "rows_checked", "rows_checked_delta", "rows_empty", "rows_empty_delta", "rows_maxlen", "rows_maxlen_delta", "rows_skipped", "rows_skipped_delta"], "type": "object", "properties": {"rows_checked_delta": {"type": "integer"}, "rows_skipped": {"type": "integer"}, "closed_pruned_delta": {"type": "integer"}, "rows_maxlen_delta": {"type": "integer"}, "flows_notimeout": {"type": "integer"}, "rows_empty_delta": {"type": "integer"}, "flows_removed": {"type": "integer"}, "est_pruned": {"type": "integer"}, "flows_removed_delta": {"type": "integer"}, "flows_timeout_inuse": {"type": "integer"}, "est_pruned_delta": {"type": "integer"}, "rows_busy": {"type": "integer"}, "flows_timeout": {"type": "integer"}, "new_pruned": {"type": "integer"}, "bypassed_pruned_delta": {"type": "integer"}, "flows_checked_delta": {"type": "integer"}, "rows_skipped_delta": {"type": "integer"}, "rows_maxlen": {"type": "integer"}, "new_pruned_delta": {"type": "integer"}, "rows_empty": {"type": "integer"}, "rows_busy_delta": {"type": "integer"}, "flows_notimeout_delta": {"type": "integer"}, "closed_pruned": {"type": "integer"}, "flows_timeout_inuse_delta": {"type": "integer"}, "bypassed_pruned": {"type": "integer"}, "flows_timeout_delta": {"type": "integer"}, "flows_checked": {"type": "integer"}, "rows_checked": {"type": "integer"}}}, "uptime": {"type": "integer"}, "detect": {"required": ["alert", "alert_delta"], "type": "object", "properties": {"alert_delta": {"type": "integer"}, "alert": {"type": "integer"}}}, "http": {"required": ["memcap", "memcap_delta", "memuse", "memuse_delta"], "type": "object", "properties": {"memcap": {"type": "integer"}, "memcap_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "memuse_delta": {"type": "integer"}}}, "dns": {"required": ["memcap_global", "memcap_global_delta", "memcap_state", "memcap_state_delta", "memuse", "memuse_delta"], "type": "object", "properties": {"memcap_global_delta": {"type": "integer"}, "memcap_state_delta": {"type": "integer"}, "memcap_state": {"type": "integer"}, "memuse": {"type": "integer"}, "memcap_global": {"type": "integer"}, "memuse_delta": {"type": "integer"}}}, "defrag": {"required": ["ipv4", "ipv6", "max_frag_hits", "max_frag_hits_delta"], "type": "object", "properties": {"max_frag_hits": {"type": "integer"}, "ipv4": {"required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"], "type": "object", "properties": {"timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "reassembled_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}}, "max_frag_hits_delta": {"type": "integer"}, "ipv6": {"required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"], "type": "object", "properties": {"timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "reassembled_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}}}}, "flow": {"required": ["emerg_mode_entered", "emerg_mode_entered_delta", "emerg_mode_over", "emerg_mode_over_delta", "icmpv4", "icmpv4_delta", "icmpv6", "icmpv6_delta", "memcap", "memcap_delta", "memuse", "memuse_delta", "spare", "spare_delta", "tcp", "tcp_delta", "tcp_reuse", "tcp_reuse_delta", "udp", "udp_delta"], "type": "object", "properties": {"tcp_reuse": {"type": "integer"}, "udp": {"type": "integer"}, "memcap": {"type": "integer"}, "icmpv6_delta": {"type": "integer"}, "emerg_mode_entered": {"type": "integer"}, "emerg_mode_entered_delta": {"type": "integer"}, "emerg_mode_over": {"type": "integer"}, "tcp": {"type": "integer"}, "udp_delta": {"type": "integer"}, "icmpv6": {"type": "integer"}, "icmpv4": {"type": "integer"}, "tcp_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "tcp_reuse_delta": {"type": "integer"}, "spare": {"type": "integer"}, "emerg_mode_over_delta": {"type": "integer"}, "spare_delta": {"type": "integer"}, "icmpv4_delta": {"type": "integer"}, "memcap_delta": {"type": "integer"}}}, "tcp": {"required": ["insert_data_normal_fail", "insert_data_normal_fail_delta", "insert_data_overlap_fail", "insert_data_overlap_fail_delta", "insert_list_fail", "insert_list_fail_delta", "invalid_checksum", "invalid_checksum_delta", "memuse", "memuse_delta", "no_flow", "no_flow_delta", "overlap", "overlap_delta", "overlap_diff_data", "overlap_diff_data_delta", "pseudo", "pseudo_delta", "pseudo_failed", "pseudo_failed_delta", "reassembly_gap", "reassembly_gap_delta", "reassembly_memuse", "reassembly_memuse_delta", "rst", "rst_delta", "segment_memcap_drop", "segment_memcap_drop_delta", "sessions", "sessions_delta", "ssn_memcap_drop", "ssn_memcap_drop_delta", "stream_depth_reached", "stream_depth_reached_delta", "syn", "syn_delta", "synack", "synack_delta"], "type": "object", "properties": {"overlap_delta": {"type": "integer"}, "insert_list_fail_delta": {"type": "integer"}, "insert_data_normal_fail": {"type": "integer"}, "rst_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "reassembly_memuse_delta": {"type": "integer"}, "pseudo_failed": {"type": "integer"}, "segment_memcap_drop_delta": {"type": "integer"}, "insert_data_overlap_fail_delta": {"type": "integer"}, "insert_data_overlap_fail": {"type": "integer"}, "synack_delta": {"type": "integer"}, "insert_list_fail": {"type": "integer"}, "overlap": {"type": "integer"}, "stream_depth_reached": {"type": "integer"}, "reassembly_gap": {"type": "integer"}, "overlap_diff_data": {"type": "integer"}, "no_flow": {"type": "integer"}, "ssn_memcap_drop": {"type": "integer"}, "pseudo_failed_delta": {"type": "integer"}, "sessions": {"type": "integer"}, "syn": {"type": "integer"}, "rst": {"type": "integer"}, "reassembly_memuse": {"type": "integer"}, "invalid_checksum_delta": {"type": "integer"}, "invalid_checksum": {"type": "integer"}, "overlap_diff_data_delta": {"type": "integer"}, "syn_delta": {"type": "integer"}, "no_flow_delta": {"type": "integer"}, "synack": {"type": "integer"}, "pseudo": {"type": "integer"}, "pseudo_delta": {"type": "integer"}, "sessions_delta": {"type": "integer"}, "stream_depth_reached_delta": {"type": "integer"}, "segment_memcap_drop": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "ssn_memcap_drop_delta": {"type": "integer"}, "insert_data_normal_fail_delta": {"type": "integer"}, "reassembly_gap_delta": {"type": "integer"}}}, "threads": {"patternProperties": {".*": {"required": ["flow"], "type": "object", "properties": {"flow_mgr": {"required": ["bypassed_pruned", "bypassed_pruned_delta", "closed_pruned", "closed_pruned_delta", "est_pruned", "est_pruned_delta", "flows_checked", "flows_checked_delta", "flows_notimeout", "flows_notimeout_delta", "flows_removed", "flows_removed_delta", "flows_timeout", "flows_timeout_delta", "flows_timeout_inuse", "flows_timeout_inuse_delta", "new_pruned", "new_pruned_delta", "rows_busy", "rows_busy_delta", "rows_checked", "rows_checked_delta", "rows_empty", "rows_empty_delta", "rows_maxlen", "rows_maxlen_delta", "rows_skipped", "rows_skipped_delta"], "type": "object", "properties": {"rows_checked_delta": {"type": "integer"}, "rows_skipped": {"type": "integer"}, "closed_pruned_delta": {"type": "integer"}, "rows_maxlen_delta": {"type": "integer"}, "flows_notimeout": {"type": "integer"}, "rows_empty_delta": {"type": "integer"}, "flows_removed": {"type": "integer"}, "est_pruned": {"type": "integer"}, "flows_removed_delta": {"type": "integer"}, "flows_timeout_inuse": {"type": "integer"}, "est_pruned_delta": {"type": "integer"}, "rows_busy": {"type": "integer"}, "flows_timeout": {"type": "integer"}, "new_pruned": {"type": "integer"}, "bypassed_pruned_delta": {"type": "integer"}, "flows_checked_delta": {"type": "integer"}, "rows_skipped_delta": {"type": "integer"}, "rows_maxlen": {"type": "integer"}, "new_pruned_delta": {"type": "integer"}, "rows_empty": {"type": "integer"}, "rows_busy_delta": {"type": "integer"}, "flows_notimeout_delta": {"type": "integer"}, "closed_pruned": {"type": "integer"}, "flows_timeout_inuse_delta": {"type": "integer"}, "bypassed_pruned": {"type": "integer"}, "flows_timeout_delta": {"type": "integer"}, "flows_checked": {"type": "integer"}, "rows_checked": {"type": "integer"}}}, "detect": {"required": ["alert", "alert_delta"], "type": "object", "properties": {"alert_delta": {"type": "integer"}, "alert": {"type": "integer"}}}, "http": {"required": ["memcap", "memcap_delta", "memuse", "memuse_delta"], "type": "object", "properties": {"memcap": {"type": "integer"}, "memcap_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "memuse_delta": {"type": "integer"}}}, "file_store": {"type": "object", "properties": {"open_files": {"type": "integer"}, "open_files_delta": {"type": "integer"}, "open_files_max_hit_delta": {"type": "integer"}, "open_files_max_hit": {"type": "integer"}}}, "defrag": {"required": ["ipv4", "ipv6", "max_frag_hits", "max_frag_hits_delta"], "type": "object", "properties": {"max_frag_hits": {"type": "integer"}, "ipv4": {"required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"], "type": "object", "properties": {"timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "reassembled_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}}, "max_frag_hits_delta": {"type": "integer"}, "ipv6": {"required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"], "type": "object", "properties": {"timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "reassembled_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}}}}, "flow": {"type": "object", "properties": {"tcp_reuse": {"type": "integer"}, "emerg_mode_over": {"type": "integer"}, "memcap": {"type": "integer"}, "icmpv6_delta": {"type": "integer"}, "emerg_mode_entered": {"type": "integer"}, "emerg_mode_entered_delta": {"type": "integer"}, "udp": {"type": "integer"}, "memuse": {"type": "integer"}, "udp_delta": {"type": "integer"}, "icmpv6": {"type": "integer"}, "icmpv4": {"type": "integer"}, "tcp_delta": {"type": "integer"}, "tcp": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "spare": {"type": "integer"}, "tcp_reuse_delta": {"type": "integer"}, "emerg_mode_over_delta": {"type": "integer"}, "spare_delta": {"type": "integer"}, "icmpv4_delta": {"type": "integer"}, "memcap_delta": {"type": "integer"}}}, "tcp": {"type": "object", "properties": {"overlap_delta": {"type": "integer"}, "insert_list_fail_delta": {"type": "integer"}, "insert_data_normal_fail": {"type": "integer"}, "rst_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "reassembly_memuse_delta": {"type": "integer"}, "pseudo_failed": {"type": "integer"}, "segment_memcap_drop_delta": {"type": "integer"}, "insert_data_overlap_fail_delta": {"type": "integer"}, "insert_data_overlap_fail": {"type": "integer"}, "synack_delta": {"type": "integer"}, "insert_list_fail": {"type": "integer"}, "overlap": {"type": "integer"}, "stream_depth_reached": {"type": "integer"}, "reassembly_gap": {"type": "integer"}, "overlap_diff_data": {"type": "integer"}, "no_flow": {"type": "integer"}, "ssn_memcap_drop": {"type": "integer"}, "pseudo_failed_delta": {"type": "integer"}, "sessions": {"type": "integer"}, "syn": {"type": "integer"}, "rst": {"type": "integer"}, "reassembly_memuse": {"type": "integer"}, "invalid_checksum_delta": {"type": "integer"}, "invalid_checksum": {"type": "integer"}, "overlap_diff_data_delta": {"type": "integer"}, "syn_delta": {"type": "integer"}, "no_flow_delta": {"type": "integer"}, "synack": {"type": "integer"}, "pseudo": {"type": "integer"}, "pseudo_delta": {"type": "integer"}, "sessions_delta": {"type": "integer"}, "stream_depth_reached_delta": {"type": "integer"}, "segment_memcap_drop": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "ssn_memcap_drop_delta": {"type": "integer"}, "insert_data_normal_fail_delta": {"type": "integer"}, "reassembly_gap_delta": {"type": "integer"}}}, "dns": {"required": ["memcap_global", "memcap_global_delta", "memcap_state", "memcap_state_delta", "memuse", "memuse_delta"], "type": "object", "properties": {"memcap_global_delta": {"type": "integer"}, "memcap_state_delta": {"type": "integer"}, "memcap_state": {"type": "integer"}, "memuse": {"type": "integer"}, "memcap_global": {"type": "integer"}, "memuse_delta": {"type": "integer"}}}, "decoder": {"required": ["avg_pkt_size", "avg_pkt_size_delta", "bytes", "bytes_delta", "dce", "erspan", "erspan_delta", "ethernet", "ethernet_delta", "gre", "gre_delta", "icmpv4", "icmpv4_delta", "icmpv6", "icmpv6_delta", "ieee8021ah", "ieee8021ah_delta", "invalid", "invalid_delta", "ipraw", "ipv4", "ipv4_delta", "ipv4_in_ipv6", "ipv4_in_ipv6_delta", "ipv6", "ipv6_delta", "ipv6_in_ipv6", "ipv6_in_ipv6_delta", "ltnull", "max_pkt_size", "max_pkt_size_delta", "mpls", "mpls_delta", "null", "null_delta", "pkts", "pkts_delta", "ppp", "ppp_delta", "pppoe", "pppoe_delta", "raw", "raw_delta", "sctp", "sctp_delta", "sll", "sll_delta", "tcp", "tcp_delta", "teredo", "teredo_delta", "udp", "udp_delta", "vlan", "vlan_delta", "vlan_qinq", "vlan_qinq_delta"], "type": "object", "properties": {"raw_delta": {"type": "integer"}, "invalid_delta": {"type": "integer"}, "avg_pkt_size": {"type": "integer"}, "mpls": {"type": "integer"}, "pkts_delta": {"type": "integer"}, "tcp": {"type": "integer"}, "raw": {"type": "integer"}, "tcp_delta": {"type": "integer"}, "vlan_qinq": {"type": "integer"}, "sctp_delta": {"type": "integer"}, "ethernet_delta": {"type": "integer"}, "erspan_delta": {"type": "integer"}, "null": {"type": "integer"}, "icmpv4_delta": {"type": "integer"}, "pppoe_delta": {"type": "integer"}, "icmpv6": {"type": "integer"}, "ltnull": {"required": ["pkt_too_small", "pkt_too_small_delta", "unsupported_type", "unsupported_type_delta"], "type": "object", "properties": {"unsupported_type": {"type": "integer"}, "pkt_too_small_delta": {"type": "integer"}, "unsupported_type_delta": {"type": "integer"}, "pkt_too_small": {"type": "integer"}}}, "invalid": {"type": "integer"}, "udp_delta": {"type": "integer"}, "gre": {"type": "integer"}, "ipv4": {"type": "integer"}, "ipv6": {"type": "integer"}, "pkts": {"type": "integer"}, "ipv6_in_ipv6": {"type": "integer"}, "sctp": {"type": "integer"}, "pppoe": {"type": "integer"}, "vlan_delta": {"type": "integer"}, "sll_delta": {"type": "integer"}, "ipv6_in_ipv6_delta": {"type": "integer"}, "udp": {"type": "integer"}, "dce": {"required": ["pkt_too_small", "pkt_too_small_delta"], "type": "object", "properties": {"pkt_too_small_delta": {"type": "integer"}, "pkt_too_small": {"type": "integer"}}}, "icmpv6_delta": {"type": "integer"}, "bytes_delta": {"type": "integer"}, "gre_delta": {"type": "integer"}, "vlan": {"type": "integer"}, "teredo_delta": {"type": "integer"}, "ieee8021ah_delta": {"type": "integer"}, "ipv4_in_ipv6_delta": {"type": "integer"}, "ipv4_delta": {"type": "integer"}, "ipraw": {"required": ["invalid_ip_version", "invalid_ip_version_delta"], "type": "object", "properties": {"invalid_ip_version": {"type": "integer"}, "invalid_ip_version_delta": {"type": "integer"}}}, "max_pkt_size_delta": {"type": "integer"}, "max_pkt_size": {"type": "integer"}, "teredo": {"type": "integer"}, "null_delta": {"type": "integer"}, "ppp_delta": {"type": "integer"}, "bytes": {"type": "integer"}, "avg_pkt_size_delta": {"type": "integer"}, "sll": {"type": "integer"}, "mpls_delta": {"type": "integer"}, "icmpv4": {"type": "integer"}, "ipv6_delta": {"type": "integer"}, "erspan": {"type": "integer"}, "ppp": {"type": "integer"}, "ethernet": {"type": "integer"}, "vlan_qinq_delta": {"type": "integer"}, "ipv4_in_ipv6": {"type": "integer"}, "ieee8021ah": {"type": "integer"}}}, "app_layer": {"required": ["flow", "tx"], "type": "object", "properties": {"flow": {"required": ["dcerpc_tcp", "dcerpc_tcp_delta", "dcerpc_udp", "dcerpc_udp_delta", "dnp3", "dnp3_delta", "dns_tcp", "dns_tcp_delta", "dns_udp", "dns_udp_delta", "enip_tcp", "enip_tcp_delta", "enip_udp", "enip_udp_delta", "failed_tcp", "failed_tcp_delta", "failed_udp", "failed_udp_delta", "ftp", "ftp_delta", "http", "http_delta", "imap", "imap_delta", "modbus", "modbus_delta", "msn", "msn_delta", "smb", "smb_delta", "smtp", "smtp_delta", "ssh", "ssh_delta", "tls", "tls_delta"], "type": "object", "properties": {"dns_tcp_delta": {"type": "integer"}, "dns_tcp": {"type": "integer"}, "smtp": {"type": "integer"}, "ftp_delta": {"type": "integer"}, "smb_delta": {"type": "integer"}, "dnp3": {"type": "integer"}, "dcerpc_udp": {"type": "integer"}, "enip_tcp_delta": {"type": "integer"}, "ssh_delta": {"type": "integer"}, "ftp": {"type": "integer"}, "tls_delta": {"type": "integer"}, "dcerpc_tcp_delta": {"type": "integer"}, "dns_udp_delta": {"type": "integer"}, "msn": {"type": "integer"}, "smb": {"type": "integer"}, "msn_delta": {"type": "integer"}, "http": {"type": "integer"}, "dns_udp": {"type": "integer"}, "dcerpc_udp_delta": {"type": "integer"}, "enip_udp_delta": {"type": "integer"}, "ssh": {"type": "integer"}, "failed_tcp_delta": {"type": "integer"}, "http_delta": {"type": "integer"}, "dcerpc_tcp": {"type": "integer"}, "imap": {"type": "integer"}, "enip_tcp": {"type": "integer"}, "failed_udp": {"type": "integer"}, "tls": {"type": "integer"}, "failed_udp_delta": {"type": "integer"}, "modbus": {"type": "integer"}, "smtp_delta": {"type": "integer"}, "imap_delta": {"type": "integer"}, "enip_udp": {"type": "integer"}, "modbus_delta": {"type": "integer"}, "dnp3_delta": {"type": "integer"}, "failed_tcp": {"type": "integer"}}}, "tx": {"required": ["dcerpc_tcp", "dcerpc_tcp_delta", "dcerpc_udp", "dcerpc_udp_delta", "dnp3", "dnp3_delta", "dns_tcp", "dns_tcp_delta", "dns_udp", "dns_udp_delta", "enip_tcp", "enip_tcp_delta", "enip_udp", "enip_udp_delta", "ftp", "ftp_delta", "http", "http_delta", "modbus", "modbus_delta", "smb", "smb_delta", "smtp", "smtp_delta", "ssh", "ssh_delta", "tls", "tls_delta"], "type": "object", "properties": {"dns_tcp_delta": {"type": "integer"}, "dns_tcp": {"type": "integer"}, "smtp": {"type": "integer"}, "ftp_delta": {"type": "integer"}, "smb_delta": {"type": "integer"}, "dnp3": {"type": "integer"}, "dcerpc_udp": {"type": "integer"}, "enip_tcp_delta": {"type": "integer"}, "ssh_delta": {"type": "integer"}, "ftp": {"type": "integer"}, "tls_delta": {"type": "integer"}, "dcerpc_tcp_delta": {"type": "integer"}, "dns_udp_delta": {"type": "integer"}, "smb": {"type": "integer"}, "http": {"type": "integer"}, "dns_udp": {"type": "integer"}, "dcerpc_udp_delta": {"type": "integer"}, "enip_udp_delta": {"type": "integer"}, "ssh": {"type": "integer"}, "http_delta": {"type": "integer"}, "dcerpc_tcp": {"type": "integer"}, "enip_tcp": {"type": "integer"}, "tls": {"type": "integer"}, "modbus": {"type": "integer"}, "smtp_delta": {"type": "integer"}, "enip_udp": {"type": "integer"}, "modbus_delta": {"type": "integer"}, "dnp3_delta": {"type": "integer"}}}}}}}}, "type": "object"}, "file_store": {"required": ["open_files", "open_files_delta", "open_files_max_hit", "open_files_max_hit_delta"], "type": "object", "properties": {"open_files": {"type": "integer"}, "open_files_max_hit": {"type": "integer"}, "open_files_delta": {"type": "integer"}, "open_files_max_hit_delta": {"type": "integer"}}}, "decoder": {"required": ["avg_pkt_size", "avg_pkt_size_delta", "bytes", "bytes_delta", "dce", "erspan", "erspan_delta", "ethernet", "ethernet_delta", "gre", "gre_delta", "icmpv4", "icmpv4_delta", "icmpv6", "icmpv6_delta", "ieee8021ah", "ieee8021ah_delta", "invalid", "invalid_delta", "ipraw", "ipv4", "ipv4_delta", "ipv4_in_ipv6", "ipv4_in_ipv6_delta", "ipv6", "ipv6_delta", "ipv6_in_ipv6", "ipv6_in_ipv6_delta", "ltnull", "max_pkt_size", "max_pkt_size_delta", "mpls", "mpls_delta", "null", "null_delta", "pkts", "pkts_delta", "ppp", "ppp_delta", "pppoe", "pppoe_delta", "raw", "raw_delta", "sctp", "sctp_delta", "sll", "sll_delta", "tcp", "tcp_delta", "teredo", "teredo_delta", "udp", "udp_delta", "vlan", "vlan_delta", "vlan_qinq", "vlan_qinq_delta"], "type": "object", "properties": {"raw_delta": {"type": "integer"}, "invalid_delta": {"type": "integer"}, "avg_pkt_size": {"type": "integer"}, "mpls": {"type": "integer"}, "pkts_delta": {"type": "integer"}, "tcp": {"type": "integer"}, "raw": {"type": "integer"}, "tcp_delta": {"type": "integer"}, "vlan_qinq": {"type": "integer"}, "sctp_delta": {"type": "integer"}, "ethernet_delta": {"type": "integer"}, "erspan_delta": {"type": "integer"}, "null": {"type": "integer"}, "icmpv4_delta": {"type": "integer"}, "pppoe_delta": {"type": "integer"}, "icmpv6": {"type": "integer"}, "ltnull": {"required": ["pkt_too_small", "pkt_too_small_delta", "unsupported_type", "unsupported_type_delta"], "type": "object", "properties": {"unsupported_type": {"type": "integer"}, "pkt_too_small_delta": {"type": "integer"}, "unsupported_type_delta": {"type": "integer"}, "pkt_too_small": {"type": "integer"}}}, "invalid": {"type": "integer"}, "udp_delta": {"type": "integer"}, "gre": {"type": "integer"}, "ipv4": {"type": "integer"}, "ipv6": {"type": "integer"}, "pkts": {"type": "integer"}, "ipv6_in_ipv6": {"type": "integer"}, "sctp": {"type": "integer"}, "pppoe": {"type": "integer"}, "vlan_delta": {"type": "integer"}, "sll_delta": {"type": "integer"}, "ipv6_in_ipv6_delta": {"type": "integer"}, "udp": {"type": "integer"}, "dce": {"required": ["pkt_too_small", "pkt_too_small_delta"], "type": "object", "properties": {"pkt_too_small_delta": {"type": "integer"}, "pkt_too_small": {"type": "integer"}}}, "icmpv6_delta": {"type": "integer"}, "bytes_delta": {"type": "integer"}, "gre_delta": {"type": "integer"}, "vlan": {"type": "integer"}, "teredo_delta": {"type": "integer"}, "ieee8021ah_delta": {"type": "integer"}, "ipv4_in_ipv6_delta": {"type": "integer"}, "ipv4_delta": {"type": "integer"}, "ipraw": {"required": ["invalid_ip_version", "invalid_ip_version_delta"], "type": "object", "properties": {"invalid_ip_version": {"type": "integer"}, "invalid_ip_version_delta": {"type": "integer"}}}, "max_pkt_size_delta": {"type": "integer"}, "max_pkt_size": {"type": "integer"}, "teredo": {"type": "integer"}, "null_delta": {"type": "integer"}, "ppp_delta": {"type": "integer"}, "bytes": {"type": "integer"}, "avg_pkt_size_delta": {"type": "integer"}, "sll": {"type": "integer"}, "mpls_delta": {"type": "integer"}, "icmpv4": {"type": "integer"}, "ipv6_delta": {"type": "integer"}, "erspan": {"type": "integer"}, "ppp": {"type": "integer"}, "ethernet": {"type": "integer"}, "vlan_qinq_delta": {"type": "integer"}, "ipv4_in_ipv6": {"type": "integer"}, "ieee8021ah": {"type": "integer"}}}, "app_layer": {"required": ["flow", "tx"], "type": "object", "properties": {"flow": {"required": ["dcerpc_tcp", "dcerpc_tcp_delta", "dcerpc_udp", "dcerpc_udp_delta", "dnp3", "dnp3_delta", "dns_tcp", "dns_tcp_delta", "dns_udp", "dns_udp_delta", "enip_tcp", "enip_tcp_delta", "enip_udp", "enip_udp_delta", "failed_tcp", "failed_tcp_delta", "failed_udp", "failed_udp_delta", "ftp", "ftp_delta", "http", "http_delta", "imap", "imap_delta", "modbus", "modbus_delta", "msn", "msn_delta", "smb", "smb_delta", "smtp", "smtp_delta", "ssh", "ssh_delta", "tls", "tls_delta"], "type": "object", "properties": {"dns_tcp_delta": {"type": "integer"}, "dns_tcp": {"type": "integer"}, "smtp": {"type": "integer"}, "ftp_delta": {"type": "integer"}, "smb_delta": {"type": "integer"}, "dnp3": {"type": "integer"}, "dcerpc_udp": {"type": "integer"}, "enip_tcp_delta": {"type": "integer"}, "ssh_delta": {"type": "integer"}, "ftp": {"type": "integer"}, "tls_delta": {"type": "integer"}, "dcerpc_tcp_delta": {"type": "integer"}, "dns_udp_delta": {"type": "integer"}, "msn": {"type": "integer"}, "smb": {"type": "integer"}, "msn_delta": {"type": "integer"}, "http": {"type": "integer"}, "dns_udp": {"type": "integer"}, "dcerpc_udp_delta": {"type": "integer"}, "enip_udp_delta": {"type": "integer"}, "ssh": {"type": "integer"}, "failed_tcp_delta": {"type": "integer"}, "http_delta": {"type": "integer"}, "dcerpc_tcp": {"type": "integer"}, "imap": {"type": "integer"}, "enip_tcp": {"type": "integer"}, "failed_udp": {"type": "integer"}, "tls": {"type": "integer"}, "failed_udp_delta": {"type": "integer"}, "modbus": {"type": "integer"}, "smtp_delta": {"type": "integer"}, "imap_delta": {"type": "integer"}, "enip_udp": {"type": "integer"}, "modbus_delta": {"type": "integer"}, "dnp3_delta": {"type": "integer"}, "failed_tcp": {"type": "integer"}}}, "tx": {"required": ["dcerpc_tcp", "dcerpc_tcp_delta", "dcerpc_udp", "dcerpc_udp_delta", "dnp3", "dnp3_delta", "dns_tcp", "dns_tcp_delta", "dns_udp", "dns_udp_delta", "enip_tcp", "enip_tcp_delta", "enip_udp", "enip_udp_delta", "ftp", "ftp_delta", "http", "http_delta", "modbus", "modbus_delta", "smb", "smb_delta", "smtp", "smtp_delta", "ssh", "ssh_delta", "tls", "tls_delta"], "type": "object", "properties": {"dns_tcp_delta": {"type": "integer"}, "dns_tcp": {"type": "integer"}, "smtp": {"type": "integer"}, "ftp_delta": {"type": "integer"}, "smb_delta": {"type": "integer"}, "dnp3": {"type": "integer"}, "dcerpc_udp": {"type": "integer"}, "enip_tcp_delta": {"type": "integer"}, "ssh_delta": {"type": "integer"}, "ftp": {"type": "integer"}, "tls_delta": {"type": "integer"}, "dcerpc_tcp_delta": {"type": "integer"}, "dns_udp_delta": {"type": "integer"}, "smb": {"type": "integer"}, "http": {"type": "integer"}, "dns_udp": {"type": "integer"}, "dcerpc_udp_delta": {"type": "integer"}, "enip_udp_delta": {"type": "integer"}, "ssh": {"type": "integer"}, "http_delta": {"type": "integer"}, "dcerpc_tcp": {"type": "integer"}, "enip_tcp": {"type": "integer"}, "tls": {"type": "integer"}, "modbus": {"type": "integer"}, "smtp_delta": {"type": "integer"}, "enip_udp": {"type": "integer"}, "modbus_delta": {"type": "integer"}, "dnp3_delta": {"type": "integer"}}}}}}}, "netflow": {"required": ["age", "bytes", "end", "pkts", "start"], "type": "object", "properties": {"pkts": {"type": "integer"}, "start": {"type": "string"}, "age": {"type": "integer"}, "end": {"type": "string"}, "bytes": {"type": "integer"}}}, "ssh": {"required": ["client", "server"], "type": "object", "properties": {"client": {"type": "object", "properties": {"proto_version": {"type": "string"}, "software_version": {"type": "string"}}}, "server": {"type": "object", "properties": {"proto_version": {"type": "string"}, "software_version": {"type": "string"}}}}}, "tls": {"required": ["version"], "type": "object", "properties": {"notbefore": {"type": "string"}, "from_proto": {"type": "string"}, "issuerdn": {"type": "string"}, "sni": {"type": "string"}, "version": {"type": "string"}, "session_resumed": {"type": "boolean"}, "fingerprint": {"type": "string"}, "serial": {"type": "string"}, "notafter": {"type": "string"}, "subject": {"type": "string"}}}, "app_proto_ts": {"type": "string"}, "tunnel": {"required": ["depth", "dest_ip", "proto", "src_ip"], "type": "object", "properties": {"src_port": {"type": "integer"}, "proto": {"type": "string"}, "src_ip": {"type": "string"}, "depth": {"type": "integer"}, "dest_ip": {"type": "string"}, "dest_port": {"type": "integer"}}}, "flow": {"required": ["bytes_toclient", "bytes_toserver", "pkts_toclient", "pkts_toserver", "start"], "type": "object", "properties": {"bytes_toclient": {"type": "integer"}, "emergency": {"type": "boolean"}, "pkts_toclient": {"type": "integer"}, "age": {"type": "integer"}, "reason": {"type": "string"}, "start": {"type": "string"}, "state": {"type": "string"}, "pkts_toserver": {"type": "integer"}, "bytes_toserver": {"type": "integer"}, "end": {"type": "string"}, "alerted": {"type": "boolean"}}}, "app_proto": {"type": "string"}, "tx_id": {"type": "integer"}, "app_proto_tc": {"type": "string"}, "app_proto_expected": {"type": "string"}}}
