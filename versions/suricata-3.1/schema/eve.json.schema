{"$schema": "http://json-schema.org/schema#", "required": ["timestamp"], "type": "object", "properties": {"event_type": {"type": "string"}, "vars": {"type": "object", "properties": {"flowbits": {"patternProperties": {".*": {}}}, "flowints": {"patternProperties": {".*": {}}}}}, "smtp": {"required": ["helo"], "type": "object", "properties": {"rcpt_to": {"items": {"type": "string"}, "type": "array"}, "mail_from": {"type": "string"}, "helo": {"type": "string"}}}, "tcp": {"required": ["tcp_flags"], "type": "object", "properties": {"tcp_flags": {"type": "string"}, "psh": {"type": "boolean"}, "urg": {"type": "boolean"}, "tcp_flags_tc": {"type": "string"}, "ack": {"type": "boolean"}, "ecn": {"type": "boolean"}, "cwr": {"type": "boolean"}, "syn": {"type": "boolean"}, "state": {"type": "string"}, "tcp_flags_ts": {"type": "string"}, "rst": {"type": "boolean"}, "fin": {"type": "boolean"}}}, "fileinfo": {"required": ["filename", "size", "state", "stored", "tx_id"], "type": "object", "properties": {"magic": {"type": "string"}, "filename": {"type": "string"}, "tx_id": {"type": "integer"}, "state": {"type": "string"}, "stored": {"type": "boolean"}, "file_id": {"type": "integer"}, "size": {"type": "integer"}, "md5": {"type": "string"}}}, "icmp_type": {"type": "integer"}, "payload": {"type": "string"}, "dest_port": {"type": "integer"}, "payload_printable": {"type": "string"}, "src_port": {"type": "integer"}, "stream": {"type": "integer"}, "proto": {"type": "string"}, "pcap_cnt": {"type": "integer"}, "src_ip": {"type": "string"}, "dns": {"required": ["id", "type"], "type": "object", "properties": {"grouped": {"patternProperties": {"[A-Z]+": {}}}, "type": {"type": "string"}, "rrtype": {"type": "string"}, "rrname": {"type": "string"}, "rdata": {"type": "string"}, "tx_id": {"type": "integer"}, "ttl": {"type": "integer"}, "rcode": {"type": "string"}, "id": {"type": "integer"}}}, "flow_id": {"type": "integer"}, "email": {"required": ["status"], "type": "object", "properties": {"status": {"type": "string"}, "from": {"type": "string"}, "subject_md5": {"type": "string"}, "to": {"items": {"type": "string"}, "type": "array"}, "attachment": {"items": {"type": "string"}, "type": "array"}, "body_md5": {"type": "string"}}}, "dest_ip": {"type": "string"}, "icmp_code": {"type": "integer"}, "http": {"required": ["length"], "type": "object", "properties": {"status": {"type": "integer"}, "redirect": {"type": "string"}, "http_user_agent": {"type": "string"}, "protocol": {"type": "string"}, "http_refer": {"type": "string"}, "url": {"type": "string"}, "hostname": {"type": "string"}, "length": {"type": "integer"}, "http_method": {"type": "string"}, "http_content_type": {"type": "string"}}}, "timestamp": {"type": "string"}, "vlan": {"anyOf": [{"type": "integer"}, {"items": {"type": "integer"}, "type": "array"}]}, "in_iface": {"type": "string"}, "alert": {"required": ["action", "category", "gid", "rev", "severity", "signature", "signature_id"], "type": "object", "properties": {"category": {"type": "string"}, "severity": {"type": "integer"}, "rev": {"type": "integer"}, "gid": {"type": "integer"}, "signature": {"type": "string"}, "action": {"type": "string"}, "signature_id": {"type": "integer"}}}, "packet": {"type": "string"}, "stats": {"required": ["decoder", "defrag", "detect", "dns", "flow", "flow_mgr", "http", "stream", "tcp", "threads", "uptime"], "type": "object", "properties": {"flow_mgr": {"required": ["closed_pruned", "closed_pruned_delta", "est_pruned", "est_pruned_delta", "new_pruned", "new_pruned_delta"], "type": "object", "properties": {"closed_pruned": {"type": "integer"}, "new_pruned": {"type": "integer"}, "closed_pruned_delta": {"type": "integer"}, "est_pruned": {"type": "integer"}, "est_pruned_delta": {"type": "integer"}, "new_pruned_delta": {"type": "integer"}}}, "uptime": {"type": "integer"}, "detect": {"required": ["alert", "alert_delta"], "type": "object", "properties": {"alert_delta": {"type": "integer"}, "alert": {"type": "integer"}}}, "http": {"required": ["memcap", "memcap_delta", "memuse", "memuse_delta"], "type": "object", "properties": {"memcap": {"type": "integer"}, "memcap_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "memuse_delta": {"type": "integer"}}}, "stream": {"required": ["3whs_ack_in_wrong_dir", "3whs_ack_in_wrong_dir_delta", "3whs_async_wrong_seq", "3whs_async_wrong_seq_delta", "3whs_right_seq_wrong_ack_evasion", "3whs_right_seq_wrong_ack_evasion_delta"], "type": "object", "properties": {"3whs_async_wrong_seq_delta": {"type": "integer"}, "3whs_ack_in_wrong_dir_delta": {"type": "integer"}, "3whs_right_seq_wrong_ack_evasion_delta": {"type": "integer"}, "3whs_ack_in_wrong_dir": {"type": "integer"}, "3whs_right_seq_wrong_ack_evasion": {"type": "integer"}, "3whs_async_wrong_seq": {"type": "integer"}}}, "defrag": {"required": ["ipv4", "ipv6", "max_frag_hits", "max_frag_hits_delta"], "type": "object", "properties": {"max_frag_hits": {"type": "integer"}, "ipv4": {"required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"], "type": "object", "properties": {"timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "reassembled_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}}, "max_frag_hits_delta": {"type": "integer"}, "ipv6": {"required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"], "type": "object", "properties": {"timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "reassembled_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}}}}, "flow": {"required": ["emerg_mode_entered", "emerg_mode_entered_delta", "emerg_mode_over", "emerg_mode_over_delta", "memcap", "memcap_delta", "memuse", "memuse_delta", "spare", "spare_delta", "tcp_reuse", "tcp_reuse_delta"], "type": "object", "properties": {"tcp_reuse": {"type": "integer"}, "emerg_mode_over": {"type": "integer"}, "memcap": {"type": "integer"}, "emerg_mode_entered": {"type": "integer"}, "emerg_mode_entered_delta": {"type": "integer"}, "memcap_delta": {"type": "integer"}, "spare": {"type": "integer"}, "memuse": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "tcp_reuse_delta": {"type": "integer"}, "spare_delta": {"type": "integer"}, "emerg_mode_over_delta": {"type": "integer"}}}, "tcp": {"required": ["invalid_checksum", "invalid_checksum_delta", "memuse", "memuse_delta", "no_flow", "no_flow_delta", "pseudo", "pseudo_delta", "pseudo_failed", "pseudo_failed_delta", "reassembly_gap", "reassembly_gap_delta", "reassembly_memuse", "reassembly_memuse_delta", "rst", "rst_delta", "segment_memcap_drop", "segment_memcap_drop_delta", "sessions", "sessions_delta", "ssn_memcap_drop", "ssn_memcap_drop_delta", "stream_depth_reached", "stream_depth_reached_delta", "syn", "syn_delta", "synack", "synack_delta"], "type": "object", "properties": {"rst_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "reassembly_memuse_delta": {"type": "integer"}, "pseudo_failed": {"type": "integer"}, "segment_memcap_drop_delta": {"type": "integer"}, "synack_delta": {"type": "integer"}, "stream_depth_reached": {"type": "integer"}, "reassembly_gap": {"type": "integer"}, "no_flow": {"type": "integer"}, "ssn_memcap_drop": {"type": "integer"}, "pseudo_failed_delta": {"type": "integer"}, "sessions": {"type": "integer"}, "syn": {"type": "integer"}, "rst": {"type": "integer"}, "reassembly_memuse": {"type": "integer"}, "invalid_checksum_delta": {"type": "integer"}, "invalid_checksum": {"type": "integer"}, "syn_delta": {"type": "integer"}, "no_flow_delta": {"type": "integer"}, "synack": {"type": "integer"}, "pseudo": {"type": "integer"}, "pseudo_delta": {"type": "integer"}, "sessions_delta": {"type": "integer"}, "stream_depth_reached_delta": {"type": "integer"}, "segment_memcap_drop": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "ssn_memcap_drop_delta": {"type": "integer"}, "reassembly_gap_delta": {"type": "integer"}}}, "threads": {"patternProperties": {".*": {"type": "object", "properties": {"flow_mgr": {"required": ["closed_pruned", "closed_pruned_delta", "est_pruned", "est_pruned_delta", "new_pruned", "new_pruned_delta"], "type": "object", "properties": {"closed_pruned": {"type": "integer"}, "new_pruned": {"type": "integer"}, "closed_pruned_delta": {"type": "integer"}, "est_pruned": {"type": "integer"}, "est_pruned_delta": {"type": "integer"}, "new_pruned_delta": {"type": "integer"}}}, "detect": {"required": ["alert", "alert_delta"], "type": "object", "properties": {"alert_delta": {"type": "integer"}, "alert": {"type": "integer"}}}, "http": {"required": ["memcap", "memcap_delta", "memuse", "memuse_delta"], "type": "object", "properties": {"memcap": {"type": "integer"}, "memcap_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "memuse_delta": {"type": "integer"}}}, "stream": {"required": ["3whs_ack_in_wrong_dir", "3whs_ack_in_wrong_dir_delta", "3whs_async_wrong_seq", "3whs_async_wrong_seq_delta", "3whs_right_seq_wrong_ack_evasion", "3whs_right_seq_wrong_ack_evasion_delta"], "type": "object", "properties": {"3whs_async_wrong_seq_delta": {"type": "integer"}, "3whs_ack_in_wrong_dir_delta": {"type": "integer"}, "3whs_right_seq_wrong_ack_evasion_delta": {"type": "integer"}, "3whs_ack_in_wrong_dir": {"type": "integer"}, "3whs_right_seq_wrong_ack_evasion": {"type": "integer"}, "3whs_async_wrong_seq": {"type": "integer"}}}, "defrag": {"required": ["ipv4", "ipv6", "max_frag_hits", "max_frag_hits_delta"], "type": "object", "properties": {"max_frag_hits": {"type": "integer"}, "ipv4": {"required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"], "type": "object", "properties": {"timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "reassembled_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}}, "max_frag_hits_delta": {"type": "integer"}, "ipv6": {"required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"], "type": "object", "properties": {"timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "reassembled_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}}}}, "flow": {"type": "object", "properties": {"tcp_reuse": {"type": "integer"}, "emerg_mode_over": {"type": "integer"}, "memcap": {"type": "integer"}, "emerg_mode_entered": {"type": "integer"}, "emerg_mode_entered_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "tcp_reuse_delta": {"type": "integer"}, "memcap_delta": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "spare": {"type": "integer"}, "spare_delta": {"type": "integer"}, "emerg_mode_over_delta": {"type": "integer"}}}, "tcp": {"type": "object", "properties": {"rst_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "reassembly_memuse_delta": {"type": "integer"}, "pseudo_failed": {"type": "integer"}, "segment_memcap_drop_delta": {"type": "integer"}, "synack_delta": {"type": "integer"}, "stream_depth_reached": {"type": "integer"}, "reassembly_gap": {"type": "integer"}, "no_flow": {"type": "integer"}, "ssn_memcap_drop": {"type": "integer"}, "pseudo_failed_delta": {"type": "integer"}, "sessions": {"type": "integer"}, "syn": {"type": "integer"}, "rst": {"type": "integer"}, "reassembly_memuse": {"type": "integer"}, "invalid_checksum_delta": {"type": "integer"}, "invalid_checksum": {"type": "integer"}, "syn_delta": {"type": "integer"}, "no_flow_delta": {"type": "integer"}, "synack": {"type": "integer"}, "pseudo": {"type": "integer"}, "pseudo_delta": {"type": "integer"}, "sessions_delta": {"type": "integer"}, "stream_depth_reached_delta": {"type": "integer"}, "segment_memcap_drop": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "ssn_memcap_drop_delta": {"type": "integer"}, "reassembly_gap_delta": {"type": "integer"}}}, "dns": {"required": ["memcap_global", "memcap_global_delta", "memcap_state", "memcap_state_delta", "memuse", "memuse_delta"], "type": "object", "properties": {"memcap_global_delta": {"type": "integer"}, "memcap_state_delta": {"type": "integer"}, "memcap_state": {"type": "integer"}, "memuse": {"type": "integer"}, "memcap_global": {"type": "integer"}, "memuse_delta": {"type": "integer"}}}, "decoder": {"required": ["avg_pkt_size", "avg_pkt_size_delta", "bytes", "bytes_delta", "erspan", "erspan_delta", "ethernet", "ethernet_delta", "gre", "gre_delta", "icmpv4", "icmpv4_delta", "icmpv6", "icmpv6_delta", "invalid", "invalid_delta", "ipraw", "ipv4", "ipv4_delta", "ipv4_in_ipv6", "ipv4_in_ipv6_delta", "ipv6", "ipv6_delta", "ipv6_in_ipv6", "ipv6_in_ipv6_delta", "ltnull", "max_pkt_size", "max_pkt_size_delta", "mpls", "mpls_delta", "null", "null_delta", "pkts", "pkts_delta", "ppp", "ppp_delta", "pppoe", "pppoe_delta", "raw", "raw_delta", "sctp", "sctp_delta", "sll", "sll_delta", "tcp", "tcp_delta", "teredo", "teredo_delta", "udp", "udp_delta", "vlan", "vlan_delta", "vlan_qinq", "vlan_qinq_delta"], "type": "object", "properties": {"raw_delta": {"type": "integer"}, "invalid_delta": {"type": "integer"}, "avg_pkt_size": {"type": "integer"}, "mpls": {"type": "integer"}, "pkts_delta": {"type": "integer"}, "tcp": {"type": "integer"}, "raw": {"type": "integer"}, "tcp_delta": {"type": "integer"}, "vlan_qinq": {"type": "integer"}, "sctp_delta": {"type": "integer"}, "ethernet_delta": {"type": "integer"}, "erspan_delta": {"type": "integer"}, "null": {"type": "integer"}, "icmpv4_delta": {"type": "integer"}, "pppoe_delta": {"type": "integer"}, "icmpv6": {"type": "integer"}, "ltnull": {"required": ["pkt_too_small", "pkt_too_small_delta", "unsupported_type", "unsupported_type_delta"], "type": "object", "properties": {"unsupported_type": {"type": "integer"}, "pkt_too_small_delta": {"type": "integer"}, "unsupported_type_delta": {"type": "integer"}, "pkt_too_small": {"type": "integer"}}}, "invalid": {"type": "integer"}, "udp_delta": {"type": "integer"}, "gre": {"type": "integer"}, "ipv4": {"type": "integer"}, "ipv6": {"type": "integer"}, "pkts": {"type": "integer"}, "ipv6_in_ipv6": {"type": "integer"}, "sctp": {"type": "integer"}, "pppoe": {"type": "integer"}, "vlan_delta": {"type": "integer"}, "sll_delta": {"type": "integer"}, "ipv6_in_ipv6_delta": {"type": "integer"}, "udp": {"type": "integer"}, "icmpv6_delta": {"type": "integer"}, "bytes_delta": {"type": "integer"}, "gre_delta": {"type": "integer"}, "vlan": {"type": "integer"}, "teredo_delta": {"type": "integer"}, "ipv4_in_ipv6_delta": {"type": "integer"}, "ipv4_delta": {"type": "integer"}, "ipraw": {"required": ["invalid_ip_version", "invalid_ip_version_delta"], "type": "object", "properties": {"invalid_ip_version": {"type": "integer"}, "invalid_ip_version_delta": {"type": "integer"}}}, "max_pkt_size_delta": {"type": "integer"}, "max_pkt_size": {"type": "integer"}, "teredo": {"type": "integer"}, "null_delta": {"type": "integer"}, "ppp_delta": {"type": "integer"}, "bytes": {"type": "integer"}, "avg_pkt_size_delta": {"type": "integer"}, "sll": {"type": "integer"}, "mpls_delta": {"type": "integer"}, "icmpv4": {"type": "integer"}, "ipv6_delta": {"type": "integer"}, "erspan": {"type": "integer"}, "ppp": {"type": "integer"}, "ethernet": {"type": "integer"}, "vlan_qinq_delta": {"type": "integer"}, "ipv4_in_ipv6": {"type": "integer"}}}}}}, "type": "object"}, "dns": {"required": ["memcap_global", "memcap_global_delta", "memcap_state", "memcap_state_delta", "memuse", "memuse_delta"], "type": "object", "properties": {"memcap_global_delta": {"type": "integer"}, "memcap_state_delta": {"type": "integer"}, "memcap_state": {"type": "integer"}, "memuse": {"type": "integer"}, "memcap_global": {"type": "integer"}, "memuse_delta": {"type": "integer"}}}, "decoder": {"required": ["avg_pkt_size", "avg_pkt_size_delta", "bytes", "bytes_delta", "erspan", "erspan_delta", "ethernet", "ethernet_delta", "gre", "gre_delta", "icmpv4", "icmpv4_delta", "icmpv6", "icmpv6_delta", "invalid", "invalid_delta", "ipraw", "ipv4", "ipv4_delta", "ipv4_in_ipv6", "ipv4_in_ipv6_delta", "ipv6", "ipv6_delta", "ipv6_in_ipv6", "ipv6_in_ipv6_delta", "ltnull", "max_pkt_size", "max_pkt_size_delta", "mpls", "mpls_delta", "null", "null_delta", "pkts", "pkts_delta", "ppp", "ppp_delta", "pppoe", "pppoe_delta", "raw", "raw_delta", "sctp", "sctp_delta", "sll", "sll_delta", "tcp", "tcp_delta", "teredo", "teredo_delta", "udp", "udp_delta", "vlan", "vlan_delta", "vlan_qinq", "vlan_qinq_delta"], "type": "object", "properties": {"raw_delta": {"type": "integer"}, "invalid_delta": {"type": "integer"}, "avg_pkt_size": {"type": "integer"}, "mpls": {"type": "integer"}, "pkts_delta": {"type": "integer"}, "tcp": {"type": "integer"}, "raw": {"type": "integer"}, "tcp_delta": {"type": "integer"}, "vlan_qinq": {"type": "integer"}, "sctp_delta": {"type": "integer"}, "ethernet_delta": {"type": "integer"}, "erspan_delta": {"type": "integer"}, "null": {"type": "integer"}, "icmpv4_delta": {"type": "integer"}, "pppoe_delta": {"type": "integer"}, "icmpv6": {"type": "integer"}, "ltnull": {"required": ["pkt_too_small", "pkt_too_small_delta", "unsupported_type", "unsupported_type_delta"], "type": "object", "properties": {"unsupported_type": {"type": "integer"}, "pkt_too_small_delta": {"type": "integer"}, "unsupported_type_delta": {"type": "integer"}, "pkt_too_small": {"type": "integer"}}}, "invalid": {"type": "integer"}, "udp_delta": {"type": "integer"}, "gre": {"type": "integer"}, "ipv4": {"type": "integer"}, "ipv6": {"type": "integer"}, "pkts": {"type": "integer"}, "ipv6_in_ipv6": {"type": "integer"}, "sctp": {"type": "integer"}, "pppoe": {"type": "integer"}, "vlan_delta": {"type": "integer"}, "sll_delta": {"type": "integer"}, "ipv6_in_ipv6_delta": {"type": "integer"}, "udp": {"type": "integer"}, "icmpv6_delta": {"type": "integer"}, "bytes_delta": {"type": "integer"}, "gre_delta": {"type": "integer"}, "vlan": {"type": "integer"}, "teredo_delta": {"type": "integer"}, "ipv4_in_ipv6_delta": {"type": "integer"}, "ipv4_delta": {"type": "integer"}, "ipraw": {"required": ["invalid_ip_version", "invalid_ip_version_delta"], "type": "object", "properties": {"invalid_ip_version": {"type": "integer"}, "invalid_ip_version_delta": {"type": "integer"}}}, "max_pkt_size_delta": {"type": "integer"}, "max_pkt_size": {"type": "integer"}, "teredo": {"type": "integer"}, "null_delta": {"type": "integer"}, "ppp_delta": {"type": "integer"}, "bytes": {"type": "integer"}, "avg_pkt_size_delta": {"type": "integer"}, "sll": {"type": "integer"}, "mpls_delta": {"type": "integer"}, "icmpv4": {"type": "integer"}, "ipv6_delta": {"type": "integer"}, "erspan": {"type": "integer"}, "ppp": {"type": "integer"}, "ethernet": {"type": "integer"}, "vlan_qinq_delta": {"type": "integer"}, "ipv4_in_ipv6": {"type": "integer"}}}}}, "netflow": {"required": ["age", "bytes", "end", "pkts", "start"], "type": "object", "properties": {"pkts": {"type": "integer"}, "start": {"type": "string"}, "age": {"type": "integer"}, "end": {"type": "string"}, "bytes": {"type": "integer"}}}, "tls": {"required": ["version"], "type": "object", "properties": {"sni": {"type": "string"}, "version": {"type": "string"}, "issuerdn": {"type": "string"}, "subject": {"type": "string"}, "fingerprint": {"type": "string"}}}, "flow": {"required": ["age", "bytes_toclient", "bytes_toserver", "end", "pkts_toclient", "pkts_toserver", "reason", "start", "state"], "type": "object", "properties": {"bytes_toclient": {"type": "integer"}, "emergency": {"type": "boolean"}, "pkts_toclient": {"type": "integer"}, "age": {"type": "integer"}, "reason": {"type": "string"}, "start": {"type": "string"}, "state": {"type": "string"}, "pkts_toserver": {"type": "integer"}, "bytes_toserver": {"type": "integer"}, "end": {"type": "string"}}}, "app_proto": {"type": "string"}, "tx_id": {"type": "integer"}, "ssh": {"required": ["client", "server"], "type": "object", "properties": {"client": {"type": "object", "properties": {"proto_version": {"type": "string"}, "software_version": {"type": "string"}}}, "server": {"type": "object", "properties": {"proto_version": {"type": "string"}, "software_version": {"type": "string"}}}}}}}
