{"type": "object", "$schema": "http://json-schema.org/schema#", "required": ["event_type", "timestamp"], "properties": {"packet": {"type": "string"}, "flow_id": {"type": "integer"}, "stats": {"type": "object", "properties": {"decoder": {"type": "object", "properties": {"ethernet_delta": {"type": "integer"}, "avg_pkt_size_delta": {"type": "integer"}, "raw_delta": {"type": "integer"}, "icmpv4": {"type": "integer"}, "teredo_delta": {"type": "integer"}, "gre": {"type": "integer"}, "ipv6_in_ipv6_delta": {"type": "integer"}, "ipv6_delta": {"type": "integer"}, "tcp_delta": {"type": "integer"}, "icmpv6_delta": {"type": "integer"}, "erspan": {"type": "integer"}, "ipv6": {"type": "integer"}, "ipv4": {"type": "integer"}, "ethernet": {"type": "integer"}, "mpls_delta": {"type": "integer"}, "pkts_delta": {"type": "integer"}, "sll": {"type": "integer"}, "gre_delta": {"type": "integer"}, "tcp": {"type": "integer"}, "vlan_delta": {"type": "integer"}, "ppp": {"type": "integer"}, "sctp": {"type": "integer"}, "vlan_qinq": {"type": "integer"}, "ipv4_delta": {"type": "integer"}, "pppoe": {"type": "integer"}, "erspan_delta": {"type": "integer"}, "max_pkt_size": {"type": "integer"}, "bytes_delta": {"type": "integer"}, "ipv4_in_ipv6": {"type": "integer"}, "icmpv4_delta": {"type": "integer"}, "pkts": {"type": "integer"}, "udp": {"type": "integer"}, "mpls": {"type": "integer"}, "pppoe_delta": {"type": "integer"}, "sctp_delta": {"type": "integer"}, "ipv6_in_ipv6": {"type": "integer"}, "ipv4_in_ipv6_delta": {"type": "integer"}, "bytes": {"type": "integer"}, "max_pkt_size_delta": {"type": "integer"}, "udp_delta": {"type": "integer"}, "teredo": {"type": "integer"}, "raw": {"type": "integer"}, "invalid_delta": {"type": "integer"}, "null_delta": {"type": "integer"}, "ppp_delta": {"type": "integer"}, "invalid": {"type": "integer"}, "icmpv6": {"type": "integer"}, "vlan": {"type": "integer"}, "sll_delta": {"type": "integer"}, "avg_pkt_size": {"type": "integer"}, "vlan_qinq_delta": {"type": "integer"}, "null": {"type": "integer"}}, "required": ["avg_pkt_size", "avg_pkt_size_delta", "bytes", "bytes_delta", "erspan", "erspan_delta", "ethernet", "ethernet_delta", "gre", "gre_delta", "icmpv4", "icmpv4_delta", "icmpv6", "icmpv6_delta", "invalid", "invalid_delta", "ipv4", "ipv4_delta", "ipv4_in_ipv6", "ipv4_in_ipv6_delta", "ipv6", "ipv6_delta", "ipv6_in_ipv6", "ipv6_in_ipv6_delta", "max_pkt_size", "max_pkt_size_delta", "mpls", "mpls_delta", "null", "null_delta", "pkts", "pkts_delta", "ppp", "ppp_delta", "pppoe", "pppoe_delta", "raw", "raw_delta", "sctp", "sctp_delta", "sll", "sll_delta", "tcp", "tcp_delta", "teredo", "teredo_delta", "udp", "udp_delta", "vlan", "vlan_delta", "vlan_qinq", "vlan_qinq_delta"]}, "flow": {"type": "object", "properties": {"memcap_delta": {"type": "integer"}, "emerg_mode_entered_delta": {"type": "integer"}, "spare_delta": {"type": "integer"}, "spare": {"type": "integer"}, "emerg_mode_entered": {"type": "integer"}, "memcap": {"type": "integer"}, "emerg_mode_over": {"type": "integer"}, "emerg_mode_over_delta": {"type": "integer"}, "tcp_reuse": {"type": "integer"}, "tcp_reuse_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "memuse_delta": {"type": "integer"}}, "required": ["emerg_mode_entered", "emerg_mode_entered_delta", "emerg_mode_over", "emerg_mode_over_delta", "memcap", "memcap_delta", "memuse", "memuse_delta", "spare", "spare_delta", "tcp_reuse", "tcp_reuse_delta"]}, "defrag": {"type": "object", "properties": {"ipv4": {"type": "object", "properties": {"reassembled_delta": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}, "required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"]}, "max_frag_hits_delta": {"type": "integer"}, "max_frag_hits": {"type": "integer"}, "ipv6": {"type": "object", "properties": {"reassembled_delta": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}, "required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"]}}, "required": ["ipv4", "ipv6", "max_frag_hits", "max_frag_hits_delta"]}, "threads": {"type": "object", "patternProperties": {".*": {"type": "object", "properties": {"http": {"type": "object", "properties": {"memcap_delta": {"type": "integer"}, "memcap": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "memuse": {"type": "integer"}}, "required": ["memcap", "memcap_delta", "memuse", "memuse_delta"]}, "dns": {"type": "object", "properties": {"memcap_state_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "memcap_global_delta": {"type": "integer"}, "memcap_global": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "memcap_state": {"type": "integer"}}, "required": ["memcap_global", "memcap_global_delta", "memcap_state", "memcap_state_delta", "memuse", "memuse_delta"]}, "defrag": {"type": "object", "properties": {"ipv4": {"type": "object", "properties": {"reassembled_delta": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}, "required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"]}, "max_frag_hits_delta": {"type": "integer"}, "max_frag_hits": {"type": "integer"}, "ipv6": {"type": "object", "properties": {"reassembled_delta": {"type": "integer"}, "fragments_delta": {"type": "integer"}, "fragments": {"type": "integer"}, "timeouts": {"type": "integer"}, "reassembled": {"type": "integer"}, "timeouts_delta": {"type": "integer"}}, "required": ["fragments", "fragments_delta", "reassembled", "reassembled_delta", "timeouts", "timeouts_delta"]}}, "required": ["ipv4", "ipv6", "max_frag_hits", "max_frag_hits_delta"]}, "detect": {"type": "object", "properties": {"alert": {"type": "integer"}, "alert_delta": {"type": "integer"}}, "required": ["alert", "alert_delta"]}, "decoder": {"type": "object", "properties": {"ethernet_delta": {"type": "integer"}, "avg_pkt_size_delta": {"type": "integer"}, "raw_delta": {"type": "integer"}, "icmpv4": {"type": "integer"}, "teredo_delta": {"type": "integer"}, "gre": {"type": "integer"}, "ipv6_in_ipv6_delta": {"type": "integer"}, "ipv6_delta": {"type": "integer"}, "tcp_delta": {"type": "integer"}, "icmpv6_delta": {"type": "integer"}, "erspan": {"type": "integer"}, "ipv6": {"type": "integer"}, "ipv4": {"type": "integer"}, "ethernet": {"type": "integer"}, "mpls_delta": {"type": "integer"}, "pkts_delta": {"type": "integer"}, "sll": {"type": "integer"}, "gre_delta": {"type": "integer"}, "tcp": {"type": "integer"}, "vlan_delta": {"type": "integer"}, "ppp": {"type": "integer"}, "sctp": {"type": "integer"}, "vlan_qinq": {"type": "integer"}, "ipv4_delta": {"type": "integer"}, "pppoe": {"type": "integer"}, "erspan_delta": {"type": "integer"}, "max_pkt_size": {"type": "integer"}, "bytes_delta": {"type": "integer"}, "ipv4_in_ipv6": {"type": "integer"}, "icmpv4_delta": {"type": "integer"}, "pkts": {"type": "integer"}, "udp": {"type": "integer"}, "mpls": {"type": "integer"}, "pppoe_delta": {"type": "integer"}, "sctp_delta": {"type": "integer"}, "ipv6_in_ipv6": {"type": "integer"}, "ipv4_in_ipv6_delta": {"type": "integer"}, "bytes": {"type": "integer"}, "max_pkt_size_delta": {"type": "integer"}, "udp_delta": {"type": "integer"}, "teredo": {"type": "integer"}, "raw": {"type": "integer"}, "invalid_delta": {"type": "integer"}, "null_delta": {"type": "integer"}, "ppp_delta": {"type": "integer"}, "invalid": {"type": "integer"}, "icmpv6": {"type": "integer"}, "vlan": {"type": "integer"}, "sll_delta": {"type": "integer"}, "avg_pkt_size": {"type": "integer"}, "vlan_qinq_delta": {"type": "integer"}, "null": {"type": "integer"}}, "required": ["avg_pkt_size", "avg_pkt_size_delta", "bytes", "bytes_delta", "erspan", "erspan_delta", "ethernet", "ethernet_delta", "gre", "gre_delta", "icmpv4", "icmpv4_delta", "icmpv6", "icmpv6_delta", "invalid", "invalid_delta", "ipv4", "ipv4_delta", "ipv4_in_ipv6", "ipv4_in_ipv6_delta", "ipv6", "ipv6_delta", "ipv6_in_ipv6", "ipv6_in_ipv6_delta", "max_pkt_size", "max_pkt_size_delta", "mpls", "mpls_delta", "null", "null_delta", "pkts", "pkts_delta", "ppp", "ppp_delta", "pppoe", "pppoe_delta", "raw", "raw_delta", "sctp", "sctp_delta", "sll", "sll_delta", "tcp", "tcp_delta", "teredo", "teredo_delta", "udp", "udp_delta", "vlan", "vlan_delta", "vlan_qinq", "vlan_qinq_delta"]}, "tcp": {"type": "object", "properties": {"rst": {"type": "integer"}, "segment_memcap_drop_delta": {"type": "integer"}, "pseudo_delta": {"type": "integer"}, "synack": {"type": "integer"}, "rst_delta": {"type": "integer"}, "synack_delta": {"type": "integer"}, "syn_delta": {"type": "integer"}, "ssn_memcap_drop": {"type": "integer"}, "syn": {"type": "integer"}, "no_flow": {"type": "integer"}, "stream_depth_reached_delta": {"type": "integer"}, "sessions_delta": {"type": "integer"}, "pseudo_failed": {"type": "integer"}, "pseudo_failed_delta": {"type": "integer"}, "invalid_checksum": {"type": "integer"}, "segment_memcap_drop": {"type": "integer"}, "reassembly_gap": {"type": "integer"}, "invalid_checksum_delta": {"type": "integer"}, "pseudo": {"type": "integer"}, "sessions": {"type": "integer"}, "memuse": {"type": "integer"}, "reassembly_memuse_delta": {"type": "integer"}, "stream_depth_reached": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "reassembly_memuse": {"type": "integer"}, "no_flow_delta": {"type": "integer"}, "ssn_memcap_drop_delta": {"type": "integer"}, "reassembly_gap_delta": {"type": "integer"}}}, "flow": {"type": "object", "properties": {"memcap_delta": {"type": "integer"}, "emerg_mode_entered_delta": {"type": "integer"}, "spare_delta": {"type": "integer"}, "spare": {"type": "integer"}, "emerg_mode_entered": {"type": "integer"}, "memcap": {"type": "integer"}, "emerg_mode_over": {"type": "integer"}, "emerg_mode_over_delta": {"type": "integer"}, "tcp_reuse": {"type": "integer"}, "tcp_reuse_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "memuse_delta": {"type": "integer"}}}, "flow_mgr": {"type": "object", "properties": {"est_pruned_delta": {"type": "integer"}, "closed_pruned_delta": {"type": "integer"}, "new_pruned_delta": {"type": "integer"}, "new_pruned": {"type": "integer"}, "closed_pruned": {"type": "integer"}, "est_pruned": {"type": "integer"}}, "required": ["closed_pruned", "closed_pruned_delta", "est_pruned", "est_pruned_delta", "new_pruned", "new_pruned_delta"]}}}}}, "detect": {"type": "object", "properties": {"alert": {"type": "integer"}, "alert_delta": {"type": "integer"}}, "required": ["alert", "alert_delta"]}, "http": {"type": "object", "properties": {"memcap_delta": {"type": "integer"}, "memcap": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "memuse": {"type": "integer"}}, "required": ["memcap", "memcap_delta", "memuse", "memuse_delta"]}, "tcp": {"type": "object", "properties": {"rst": {"type": "integer"}, "reassembly_memuse_delta": {"type": "integer"}, "pseudo_delta": {"type": "integer"}, "synack": {"type": "integer"}, "rst_delta": {"type": "integer"}, "synack_delta": {"type": "integer"}, "syn_delta": {"type": "integer"}, "ssn_memcap_drop": {"type": "integer"}, "syn": {"type": "integer"}, "no_flow": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "sessions_delta": {"type": "integer"}, "pseudo_failed": {"type": "integer"}, "pseudo_failed_delta": {"type": "integer"}, "invalid_checksum": {"type": "integer"}, "segment_memcap_drop": {"type": "integer"}, "reassembly_gap": {"type": "integer"}, "invalid_checksum_delta": {"type": "integer"}, "pseudo": {"type": "integer"}, "sessions": {"type": "integer"}, "memuse": {"type": "integer"}, "segment_memcap_drop_delta": {"type": "integer"}, "stream_depth_reached": {"type": "integer"}, "stream_depth_reached_delta": {"type": "integer"}, "reassembly_memuse": {"type": "integer"}, "no_flow_delta": {"type": "integer"}, "ssn_memcap_drop_delta": {"type": "integer"}, "reassembly_gap_delta": {"type": "integer"}}, "required": ["invalid_checksum", "invalid_checksum_delta", "memuse", "memuse_delta", "no_flow", "no_flow_delta", "pseudo", "pseudo_delta", "pseudo_failed", "pseudo_failed_delta", "reassembly_gap", "reassembly_gap_delta", "reassembly_memuse", "reassembly_memuse_delta", "rst", "rst_delta", "segment_memcap_drop", "segment_memcap_drop_delta", "sessions", "sessions_delta", "ssn_memcap_drop", "ssn_memcap_drop_delta", "stream_depth_reached", "stream_depth_reached_delta", "syn", "syn_delta", "synack", "synack_delta"]}, "dns": {"type": "object", "properties": {"memcap_state_delta": {"type": "integer"}, "memuse": {"type": "integer"}, "memcap_global_delta": {"type": "integer"}, "memcap_global": {"type": "integer"}, "memuse_delta": {"type": "integer"}, "memcap_state": {"type": "integer"}}, "required": ["memcap_global", "memcap_global_delta", "memcap_state", "memcap_state_delta", "memuse", "memuse_delta"]}, "flow_mgr": {"type": "object", "properties": {"est_pruned_delta": {"type": "integer"}, "closed_pruned_delta": {"type": "integer"}, "new_pruned_delta": {"type": "integer"}, "new_pruned": {"type": "integer"}, "closed_pruned": {"type": "integer"}, "est_pruned": {"type": "integer"}}, "required": ["closed_pruned", "closed_pruned_delta", "est_pruned", "est_pruned_delta", "new_pruned", "new_pruned_delta"]}, "uptime": {"type": "integer"}}, "required": ["decoder", "defrag", "detect", "dns", "flow", "flow_mgr", "http", "tcp", "threads", "uptime"]}, "email": {"type": "object", "properties": {"subject_md5": {"type": "string"}, "from": {"type": "string"}, "body_md5": {"type": "string"}, "attachment": {"items": {"type": "string"}, "type": "array"}, "to": {"items": {"type": "string"}, "type": "array"}, "status": {"type": "string"}}, "required": ["status"]}, "tls": {"type": "object", "properties": {"fingerprint": {"type": "string"}, "version": {"type": "string"}, "issuerdn": {"type": "string"}, "subject": {"type": "string"}, "sni": {"type": "string"}}, "required": ["version"]}, "netflow": {"type": "object", "properties": {"pkts": {"type": "integer"}, "end": {"type": "string"}, "age": {"type": "integer"}, "bytes": {"type": "integer"}, "start": {"type": "string"}}, "required": ["age", "bytes", "end", "pkts", "start"]}, "vars": {"type": "object", "properties": {"flowbits": {"patternProperties": {".*": {}}}, "flowints": {"patternProperties": {".*": {}}}}}, "dest_port": {"type": "integer"}, "smtp": {"type": "object", "properties": {"helo": {"type": "string"}, "rcpt_to": {"items": {"type": "string"}, "type": "array"}, "mail_from": {"type": "string"}}, "required": ["helo"]}, "payload": {"type": "string"}, "proto": {"type": "string"}, "payload_printable": {"type": "string"}, "app_proto": {"type": "string"}, "src_ip": {"type": "string"}, "pcap_cnt": {"type": "integer"}, "stream": {"type": "integer"}, "alert": {"type": "object", "properties": {"category": {"type": "string"}, "signature": {"type": "string"}, "rev": {"type": "integer"}, "severity": {"type": "integer"}, "signature_id": {"type": "integer"}, "gid": {"type": "integer"}, "action": {"type": "string"}}, "required": ["action", "category", "gid", "rev", "severity", "signature", "signature_id"]}, "src_port": {"type": "integer"}, "flow": {"type": "object", "properties": {"state": {"type": "string"}, "bytes_toclient": {"type": "integer"}, "end": {"type": "string"}, "start": {"type": "string"}, "reason": {"type": "string"}, "emergency": {"type": "boolean"}, "bytes_toserver": {"type": "integer"}, "pkts_toserver": {"type": "integer"}, "pkts_toclient": {"type": "integer"}, "age": {"type": "integer"}}, "required": ["age", "bytes_toclient", "bytes_toserver", "end", "pkts_toclient", "pkts_toserver", "reason", "start", "state"]}, "event_type": {"type": "string"}, "fileinfo": {"type": "object", "properties": {"state": {"type": "string"}, "size": {"type": "integer"}, "stored": {"type": "boolean"}, "md5": {"type": "string"}, "filename": {"type": "string"}, "file_id": {"type": "integer"}, "magic": {"type": "string"}, "tx_id": {"type": "integer"}}, "required": ["filename", "size", "state", "stored", "tx_id"]}, "dest_ip": {"type": "string"}, "dns": {"type": "object", "properties": {"rdata": {"type": "string"}, "id": {"type": "integer"}, "type": {"type": "string"}, "rrname": {"type": "string"}, "rcode": {"type": "string"}, "grouped": {"patternProperties": {"[A-Z]+": {}}}, "ttl": {"type": "integer"}, "tx_id": {"type": "integer"}, "rrtype": {"type": "string"}}, "required": ["id", "type"]}, "tx_id": {"type": "integer"}, "http": {"type": "object", "properties": {"http_user_agent": {"type": "string"}, "http_refer": {"type": "string"}, "http_content_type": {"type": "string"}, "protocol": {"type": "string"}, "http_method": {"type": "string"}, "length": {"type": "integer"}, "redirect": {"type": "string"}, "hostname": {"type": "string"}, "url": {"type": "string"}, "status": {"type": "integer"}}, "required": ["length"]}, "ssh": {"type": "object", "properties": {"server": {"type": "object", "properties": {"software_version": {"type": "string"}, "proto_version": {"type": "string"}}}, "client": {"type": "object", "properties": {"software_version": {"type": "string"}, "proto_version": {"type": "string"}}}}, "required": ["client", "server"]}, "vlan": {"anyOf": [{"type": "integer"}, {"items": {"type": "integer"}, "type": "array"}]}, "icmp_type": {"type": "integer"}, "tcp": {"type": "object", "properties": {"state": {"type": "string"}, "rst": {"type": "boolean"}, "psh": {"type": "boolean"}, "cwr": {"type": "boolean"}, "tcp_flags_ts": {"type": "string"}, "tcp_flags": {"type": "string"}, "syn": {"type": "boolean"}, "urg": {"type": "boolean"}, "ecn": {"type": "boolean"}, "tcp_flags_tc": {"type": "string"}, "fin": {"type": "boolean"}, "ack": {"type": "boolean"}}, "required": ["tcp_flags"]}, "timestamp": {"type": "string"}, "in_iface": {"type": "string"}, "icmp_code": {"type": "integer"}}}
